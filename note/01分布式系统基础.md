分布式系统基础
===
## 单体应用和分布式应用区别
* 单体应用
    * 开发慢
    * 启动时间长
    * 依赖庞大
* 微服务
    * 易开发，理解，维护
    * 独立部署和启动
    * 不足
        * 分布式事务
        * 服务治理
## 微服务核心基础讲解
* 核心知识 ：网关、服务发现注册、配置中心、链路追踪、负载均衡器、熔断
* 网关：路由转发 + 过滤器 ​	
    * /api/v1/pruduct/ 商品服务 ​	
    * /api/v1/order/ 订单服务 ​	
    * /api/v1/user/ 用户服务
* 服务注册发现：调用和被调用方的信息维护 
* 配置中心：管理配置，动态更新 application.properties 
* 链路追踪：分析调用链路耗时 例子：下单-》查询商品服务获取商品价格-》查询用户信息-》保存数据库 
* 负载均衡器：分发负载 
* 熔断：保护自己和被调用方
## 常见微服务框架
* dubbo: zookeeper + dubbo + springmvc/springboot
* 配套
    * 通信方式：rpc
    * 注册中心：zookeper/redis
    * 配置中心：diamond
* springcloud: 全家桶+轻松嵌入第三方组件(Netflix 奈飞)
* 配套
    * 通信方式：http restful
    * 注册中心：eruka/consul
    * 配置中心：config
    * 断路器：hystrix
    * 网关：zuul
    * 分布式追踪系统：sleuth+zipkin
## 什么是注册中心
* 理解注册中心：服务管理,核心是有个服务注册表，心跳机制动态维护
* 服务提供者provider: 启动的时候向注册中心上报自己的网络信息
* 服务消费者consumer: 启动的时候向注册中心上报自己的网络信息，拉取provider的相关网络信息
* 为什么要用：
    * 微服务应用和机器越来越多，调用方需要知道接口的网络地址，如果靠配置文件的方式去控制网络地址，对于动态新增机器，维护带来很大问题
* 主流的注册中心：
    * zookeeper、Eureka、consul、etcd 等
## CAP理论
* 指的是在一个分布式系统中，Consistency（一致性）、 Availability（可用性）、Partition tolerance（分区容错性），三者不可同时获得。
* 一致性（C）：在分布式系统中的所有数据备份，在同一时刻是否同样的值。（所有节点在同一时间的数据完全一致，越多节点，数据同步越耗时）
* 可用性（A）：负载过大后，集群整体是否还能响应客户端的读写请求。（服务一直可用，而且是正常响应时间）
* 分区容错性（P）：分区容忍性，就是高可用性，一个节点崩了，并不影响其它的节点（100个节点，挂了几个，不影响服务，越多机器越好）
* CAP理论就是说在分布式存储系统中，最多只能实现上面的两点。而由于当前的网络硬件肯定会出现延迟丢包等问题，所以分区容忍性是我们必须需要实现的。所以我们只能在一致性和可用性之间进行权衡